stages:
    - build
    - test_todo_api
    - test_main

variables:
    GO_VERSION: "1.23-alpine"

build:
    image: golang:${GO_VERSION}
    stage: build
    before_script:
        - go mod download
    script:
        - go build -o todo

test_todo_api:
    image: golang:${GO_VERSION}
    stage: test_todo_api
    before_script: 
        - go mod download
    script:
        - go test -v

test_main:
    image: golang:${GO_VERSION}
    stage: test_main
    before_script:
        - go mod download
    script:
        - cd cmd/todo
        - go test -v
